https://blog.csdn.net/zfangls/article/details/79990796

https://blog.csdn.net/qq_35430000/article/details/80485311

https://www.cnblogs.com/XHappyness/p/9337229.html

我们在开发的时候会有内测、预发布、生产等不同的环境，VUE的build只能打包 一种环境，所以需要对项目做一点改造

# vue-cli2打包项目

安装cross-env

```
npm install cross-env
```

cross-env是为了解决[windows](https://www.baidu.com/s?wd=windows&tn=24004469_oem_dg&rsv_dl=gh_pl_sl_csd)不支持NODE_ENV=development的设置方式。 
这个迷你的包能够提供一个设置环境变量的scripts，让你能够以unix方式设置环境变量，然后在windows上也能兼容运行。 

修改package.json

```
    "build": "node build/build.js",
    "internal-test": "cross-env NODE_ENV=internal-test node build/build.js --env=internal-test",
    "pre-release": "cross-env NODE_ENV=pre-release node build/build.js --env=pre-release"
```

注释 build.js中的

```
process.env.NODE_ENV = 'production'
```



方案1.修改build.js

```
// const webpackConfig = require('./webpack.prod.conf')
// 修改此处配置，用于实现打包为不同的环境
let webpackConfig
if (process.env.NODE_ENV === 'production') {
  webpackConfig = require('./webpack.prod.conf')
} else if (process.env.NODE_ENV === 'pre-release') {
  webpackConfig = require('./webpack.pre-release.conf')
} else {
  console.log('can not find process.env.NODE_ENV:' + process.env.NODE_ENV)
}
```

方案2 修改webpack.prod.conf.js



# vue-cli3打包项目

 **package.json**添加  "alpha": "vue-cli-service build --mode alpha"

```
{
  ···
  "scripts": {
    "serve": "vue-cli-service serve",    //本地运行，会把process.env.NODE_ENV设置为‘development’


    "alpha": "vue-cli-service build --mode alpha",  
    // 打包，会把process.env.NODE_ENV设置为步骤2中‘.env.alpha’文件设置的值。
    // 注意，这里 “--mode 名字“ 要和步骤2中文件名“.env.名字”名字保持一致
    

     "build": "vue-cli-service build"    //打包， 会把process.env.NODE_ENV设置为‘production’
  },
  "dependencies": {
     ···    
  },
  ···
}
```

